{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useRef, useEffect } from \"react\";\nexport const useWebSocket = url => {\n  _s();\n  const socketRef = useRef(null);\n  useEffect(() => {\n    socketRef.current = new WebSocket(url);\n    socketRef.current.onopen = () => console.log(\"WebSocket connection established.\");\n    socketRef.current.onclose = () => console.log(\"WebSocket connection closed.\");\n    socketRef.current.onerror = error => console.error(\"WebSocket error:\", error);\n    return () => {\n      if (socketRef.current) {\n        socketRef.current.close();\n      }\n    };\n  }, [url]);\n  const sendAudio = audioBlob => {\n    return new Promise((resolve, reject) => {\n      if (socketRef.current.readyState === WebSocket.OPEN) {\n        socketRef.current.send(audioBlob);\n        socketRef.current.onmessage = event => {\n          try {\n            resolve(JSON.parse(event.data));\n          } catch (error) {\n            reject(new Error(\"Invalid JSON response.\"));\n          }\n        };\n        socketRef.current.onerror = error => {\n          reject(error);\n        };\n      } else {\n        reject(new Error(\"WebSocket is not open.\"));\n      }\n    });\n  };\n  return {\n    sendAudio\n  };\n};\n_s(useWebSocket, \"8c0rAI93JE8jpOVTnobt43KkFfY=\");","map":{"version":3,"names":["useRef","useEffect","useWebSocket","url","_s","socketRef","current","WebSocket","onopen","console","log","onclose","onerror","error","close","sendAudio","audioBlob","Promise","resolve","reject","readyState","OPEN","send","onmessage","event","JSON","parse","data","Error"],"sources":["/workspaces/vc_Bot/frontend/src/hooks/useWebSocket.js"],"sourcesContent":["import { useRef, useEffect } from \"react\";\n\nexport const useWebSocket = (url) => {\n    const socketRef = useRef(null);\n\n    useEffect(() => {\n        socketRef.current = new WebSocket(url);\n\n        socketRef.current.onopen = () => console.log(\"WebSocket connection established.\");\n        socketRef.current.onclose = () => console.log(\"WebSocket connection closed.\");\n        socketRef.current.onerror = (error) => console.error(\"WebSocket error:\", error);\n\n        return () => {\n            if (socketRef.current) {\n                socketRef.current.close();\n            }\n        };\n    }, [url]);\n\n    const sendAudio = (audioBlob) => {\n        return new Promise((resolve, reject) => {\n            if (socketRef.current.readyState === WebSocket.OPEN) {\n                socketRef.current.send(audioBlob);\n\n                socketRef.current.onmessage = (event) => {\n                    try {\n                        resolve(JSON.parse(event.data));\n                    } catch (error) {\n                        reject(new Error(\"Invalid JSON response.\"));\n                    }\n                };\n\n                socketRef.current.onerror = (error) => {\n                    reject(error);\n                };\n            } else {\n                reject(new Error(\"WebSocket is not open.\"));\n            }\n        });\n    };\n\n    return { sendAudio };\n};"],"mappings":";AAAA,SAASA,MAAM,EAAEC,SAAS,QAAQ,OAAO;AAEzC,OAAO,MAAMC,YAAY,GAAIC,GAAG,IAAK;EAAAC,EAAA;EACjC,MAAMC,SAAS,GAAGL,MAAM,CAAC,IAAI,CAAC;EAE9BC,SAAS,CAAC,MAAM;IACZI,SAAS,CAACC,OAAO,GAAG,IAAIC,SAAS,CAACJ,GAAG,CAAC;IAEtCE,SAAS,CAACC,OAAO,CAACE,MAAM,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;IACjFL,SAAS,CAACC,OAAO,CAACK,OAAO,GAAG,MAAMF,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;IAC7EL,SAAS,CAACC,OAAO,CAACM,OAAO,GAAIC,KAAK,IAAKJ,OAAO,CAACI,KAAK,CAAC,kBAAkB,EAAEA,KAAK,CAAC;IAE/E,OAAO,MAAM;MACT,IAAIR,SAAS,CAACC,OAAO,EAAE;QACnBD,SAAS,CAACC,OAAO,CAACQ,KAAK,CAAC,CAAC;MAC7B;IACJ,CAAC;EACL,CAAC,EAAE,CAACX,GAAG,CAAC,CAAC;EAET,MAAMY,SAAS,GAAIC,SAAS,IAAK;IAC7B,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACpC,IAAId,SAAS,CAACC,OAAO,CAACc,UAAU,KAAKb,SAAS,CAACc,IAAI,EAAE;QACjDhB,SAAS,CAACC,OAAO,CAACgB,IAAI,CAACN,SAAS,CAAC;QAEjCX,SAAS,CAACC,OAAO,CAACiB,SAAS,GAAIC,KAAK,IAAK;UACrC,IAAI;YACAN,OAAO,CAACO,IAAI,CAACC,KAAK,CAACF,KAAK,CAACG,IAAI,CAAC,CAAC;UACnC,CAAC,CAAC,OAAOd,KAAK,EAAE;YACZM,MAAM,CAAC,IAAIS,KAAK,CAAC,wBAAwB,CAAC,CAAC;UAC/C;QACJ,CAAC;QAEDvB,SAAS,CAACC,OAAO,CAACM,OAAO,GAAIC,KAAK,IAAK;UACnCM,MAAM,CAACN,KAAK,CAAC;QACjB,CAAC;MACL,CAAC,MAAM;QACHM,MAAM,CAAC,IAAIS,KAAK,CAAC,wBAAwB,CAAC,CAAC;MAC/C;IACJ,CAAC,CAAC;EACN,CAAC;EAED,OAAO;IAAEb;EAAU,CAAC;AACxB,CAAC;AAACX,EAAA,CAxCWF,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}